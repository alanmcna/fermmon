# Apache virtual host for fermmon (Raspberry Pi)
#
# For a server with no other sites:
#
#   1. Install Apache and PHP:
#      sudo apt install apache2 php php-sqlite3 php-mbstring libapache2-mod-php
#
#   2. Enable mod_rewrite (required for clean URLs):
#      sudo a2enmod rewrite
#
#   3. Copy this file and edit the path if needed:
#      sudo cp apache-fermmon.conf /etc/apache2/sites-available/fermmon.conf
#      # Edit DocumentRoot if fermmon is not in /home/ubuntu/fermmon
#
#   4. Disable default site, enable fermmon:
#      sudo a2dissite 000-default
#      sudo a2ensite fermmon
#
#   5. Reload Apache:
#      sudo systemctl reload apache2
#
#   6. Fix "readonly database" â€“ Apache (www-data) needs write access to data/:
#      sudo ./scripts/setup-web-permissions.sh
#      sudo systemctl restart apache2
#
# Access via http://<server-ip>/ or http://fermmon.local/ (add to /etc/hosts if needed)

<VirtualHost *:80>
    ServerName fermmon.local
    DocumentRoot /home/ubuntu/fermmon/web/public

    # Reduce mod_fcgid connection noise (Accepted/Closing) in error log; keep real requests in access log
    LogLevel warn

    <Directory /home/ubuntu/fermmon/web/public>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/fermmon-error.log
    CustomLog ${APACHE_LOG_DIR}/fermmon-access.log combined
</VirtualHost>
